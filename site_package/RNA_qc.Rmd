---
title: "template page title"
output: 
  html_document:
    highlight: tango
    toc: true
    toc_float:
      collapsed: false
bibliography: BBMRIomics.bib
---

```{r, child="_setup.Rmd"}
```

## Header 2 ##

***brief description***


```{r}
"some code"
```


## Sample swap detection ##

***brief description***


<!-- Dd 2017-03-20 18:31 attempting to run the chunk below yields: -->
<!-- -- -->
<!-- No username and password provided for the MDB use stored views! -->
<!--  Show Traceback -->
<!-- Error: lexical error: invalid char in json text. /home/hhmdraisma/R/x86_64-pc-lin (right here) ------^ -->
<!-- -- -->
<!-- ==> Set "eval=FALSE" for this chunk (HD). -->
<!-- ```{r} -->
```{r, eval=FALSE}
library(BBMRIomics)
rna <- getView("getRNASeqRuns", usrpwd=RP3_MDB_USRPWD, url=RP3_MDB)
rna <- rna[!duplicated(rna$run_id),] ##drop overlapping freezes
rna <- subset(rna, qc == "passed") ##keep those passing qc
dim(rna)
write.table(rna$run_id, file="~/runids.txt", row.names=FALSE, col.names=FALSE, quote=FALSE)

runids <- read.table("~/runids.txt", header=FALSE)$V1
length(runids)
##run on shark variantcalling-script!
## AC43B7ACXX-5-6 no snps called????

source(file.path(path.package("BBMRIomics"), "scripts/Genotyping_Helpers.R"), verbose=FALSE)
source(file.path(VM_BASE_ANALYSIS, "BBMRIomics/BBMRIomics/inst", "scripts/Genotyping_Helpers.R"), verbose=FALSE)
source(file.path(VM_BASE_ANALYSIS, "BBMRIomics/BBMRIomics/R", "Genotype_Helpers.R"), verbose=FALSE)
library(VariantAnnotation)
library(BiocParallel)

RNAFile <- file.path(VM_BASE_ANALYSIS, "rnasnp", "RNAsnps50.vcf")
RNAFile <- file.path(VM_BASE_ANALYSIS, "rnasnp", "RNAsnps2600.vcf")

rnaCalls <- RNACalls(RNAFile, verbose=TRUE)
colnames(rnaCalls) <- gsub("\\.variant.*$", "", colnames(rnaCalls))
setdiff(runids, colnames(rnaCalls)) ##why are these missing bad quality?


```


<!-- ```{r} -->
```{r, eval=FALSE}

RNAFile <- file.path(VM_BASE_ANALYSIS, "rnasnp", "RNAsnps50.vcf")

genotyping(typex="RNA", typey="RNA",  filex=RNAFile, filey=NULL, cohort="ALL", out=NULL, verbose=TRUE)

genotyping(typex="RNA", typey="HRC",  filex=RNAFile, filey=NULL, cohort="ALL", out=NULL, verbose=TRUE)


```


<!-- END OF FILE. -->
